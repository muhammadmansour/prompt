<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Audit Session â€” Wathbah Auditor Assistant</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="chat-page">

  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="nav-brand">
      <div class="nav-logo">
        <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
          <rect width="28" height="28" rx="8" fill="url(#navGrad)"/>
          <path d="M8 14L12 18L20 10" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          <defs>
            <linearGradient id="navGrad" x1="0" y1="0" x2="28" y2="28">
              <stop stop-color="#3b5998"/>
              <stop offset="1" stop-color="#4a6db5"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <span class="nav-title">Wathbah Auditor Assistant</span>
    </div>
    <div class="nav-center">
      <a href="/" class="nav-btn nav-btn-ghost">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M2 6L8 2L14 6V13C14 13.6 13.6 14 13 14H3C2.4 14 2 13.6 2 13V6Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M6 14V8H10V14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Home
      </a>
    </div>
    <div class="nav-actions">
      <button class="nav-btn nav-btn-outlined" type="button" id="btn-upload-file">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M14 10V13C14 13.6 13.6 14 13 14H3C2.4 14 2 13.6 2 13V10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M11 5L8 2L5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M8 2V10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        Upload File
      </button>
    </div>
  </nav>

  <!-- Session Context Bar -->
  <div class="chat-context-bar">
    <div class="context-card" onclick="toggleContextExpand('ctx-req-details')" style="cursor:pointer">
      <div class="context-card-icon requirements-icon">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
          <path d="M3 9L7 13L15 5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="context-card-info">
        <div class="context-card-title">
          Requirements
          <svg class="ctx-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M3 5L6 8L9 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </div>
        <div class="context-card-value" id="ctx-req-count">0 selected</div>
      </div>
    </div>
    <div class="context-card" onclick="toggleContextExpand('ctx-files-details')" style="cursor:pointer">
      <div class="context-card-icon files-icon">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
          <path d="M2 6V14C2 15.1 2.9 16 4 16H14C15.1 16 16 15.1 16 14V8C16 6.9 15.1 6 14 6H9L7.5 4H4C2.9 4 2 4.9 2 6Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="context-card-info">
        <div class="context-card-title">
          Reference Files
          <svg class="ctx-chevron" width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M3 5L6 8L9 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </div>
        <div class="context-card-value" id="ctx-files-count">0 files in 0 collections</div>
      </div>
    </div>
    <div class="context-card">
      <div class="context-card-icon query-icon">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
          <path d="M4 3H14L18 7V19C18 19.6 17.6 20 17 20H4C3.4 20 3 19.6 3 19V4C3 3.4 3.4 3 4 3Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M14 3V7H18" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="context-card-info">
        <div class="context-card-title">Query Context</div>
        <div class="context-card-value" id="ctx-query-summary">No query</div>
      </div>
    </div>
  </div>
  <!-- Expandable details panels (shown below context bar) -->
  <div class="context-details-panel" id="ctx-req-details" style="display:none">
    <div class="context-details-content" id="ctx-req-list">
      <!-- Populated by JS -->
    </div>
  </div>
  <div class="context-details-panel" id="ctx-files-details" style="display:none">
    <div class="context-details-content" id="ctx-files-list">
      <!-- Populated by JS -->
    </div>
  </div>

  <!-- Chat Area -->
  <div class="chat-container">
    <div class="chat-messages" id="chat-messages">
      <!-- Messages will be rendered here by JS -->
    </div>
  </div>

  <!-- Chat Input -->
  <div class="chat-input-bar">
    <div class="chat-input-wrapper">
      <textarea
        id="chat-input"
        class="chat-input"
        placeholder="Ask about compliance, audit findings, or specific requirements..."
        rows="1"
      ></textarea>
      <button type="button" class="chat-send-btn" id="chat-send-btn" disabled>
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <path d="M18 2L9 11M18 2L12 18L9 11M18 2L2 8L9 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    <div class="chat-input-hint">Press Enter to send, Shift + Enter for new line</div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>

  <script src="chat.js"></script>
</body>
</html>
