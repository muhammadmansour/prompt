<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Framework Requirements Selector</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="32" height="32" rx="8" fill="url(#gradient)"/>
          <path d="M10 16L14 20L22 12" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          <defs>
            <linearGradient id="gradient" x1="0" y1="0" x2="32" y2="32">
              <stop stop-color="#0EA5E9"/>
              <stop offset="1" stop-color="#6366F1"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h1>Framework Requirements</h1>
      <p class="subtitle">Select a framework and requirement to get started</p>
    </header>

    <main class="main-content">
      <!-- API Key Input (Optional - can be set in .env) -->
      <details class="api-key-details">
        <summary class="api-key-summary">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 5.5V4.5C10 3.4 9.1 2.5 8 2.5C6.9 2.5 6 3.4 6 4.5V5.5M4.5 5.5H11.5C12.1 5.5 12.5 5.9 12.5 6.5V12.5C12.5 13.1 12.1 13.5 11.5 13.5H4.5C3.9 13.5 3.5 13.1 3.5 12.5V6.5C3.5 5.9 3.9 5.5 4.5 5.5Z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
          </svg>
          <span>API Key Settings</span>
          <span class="api-status" id="api-status">Using server key</span>
        </summary>
        <div class="form-group" style="margin-top: 1rem;">
          <label for="api-key-input">
            <span class="label-text">Gemini API Key (Optional)</span>
            <span class="label-hint">Override the server-side key if needed</span>
          </label>
          <div class="input-wrapper">
            <input 
              type="password" 
              id="api-key-input" 
              placeholder="Leave empty to use server key..."
              autocomplete="off"
            />
            <button type="button" class="toggle-visibility" id="toggle-api-key" aria-label="Toggle visibility">
              <svg class="icon-eye" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 4C4.5 4 1.5 10 1.5 10C1.5 10 4.5 16 10 16C15.5 16 18.5 10 18.5 10C18.5 10 15.5 4 10 4Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                <circle cx="10" cy="10" r="3" stroke="currentColor" stroke-width="1.5"/>
              </svg>
              <svg class="icon-eye-off hidden" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 3L17 17M8.5 8.5C7.8 9.2 7.5 10 7.5 10C7.5 11.4 8.6 12.5 10 12.5C10.5 12.5 11 12.3 11.5 11.5M14 14C12.8 15.3 11.4 16 10 16C4.5 16 1.5 10 1.5 10C1.5 10 3 7 6 5M10 4C15.5 4 18.5 10 18.5 10C18.5 10 17.5 12 15.5 13.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
      </details>

      <!-- Framework Select -->
      <div class="form-group">
        <label for="framework-select">
          <span class="label-text">Framework & Requirement</span>
          <span class="label-hint">Choose a compliance framework and specific requirement</span>
        </label>
        <div class="select-wrapper">
          <select id="framework-select" disabled>
            <option value="">Loading frameworks...</option>
          </select>
          <div class="select-icon">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>
      </div>

      <!-- User Prompt Textarea -->
      <div class="form-group">
        <label for="notes-textarea">
          <span class="label-text">Your Context / Prompt</span>
          <span class="label-hint">Describe your situation or ask specific questions about the requirement</span>
        </label>
        <textarea 
          id="notes-textarea" 
          placeholder="e.g., We are a government agency implementing a new digital service. What evidence do we need to demonstrate compliance with this requirement?"
          rows="5"
        ></textarea>
        <div class="textarea-footer">
          <span class="char-count"><span id="char-count">0</span> characters</span>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="btn-group">
        <button type="button" class="btn btn-primary" id="btn-analyze" disabled>
          <svg class="btn-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 2V4M10 16V18M4 10H2M18 10H16M5.05 5.05L3.63 3.63M16.37 16.37L14.95 14.95M5.05 14.95L3.63 16.37M16.37 3.63L14.95 5.05" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          <span class="btn-text">Analyze with AI</span>
          <span class="btn-loading hidden">
            <svg class="spinner" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" stroke-opacity="0.3"/>
              <path d="M10 2C14.4 2 18 5.6 18 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Analyzing...
          </span>
        </button>
        
        <button type="button" class="btn btn-secondary" id="btn-submit" disabled>
          <svg class="btn-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 10L9 16L17 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span class="btn-text">Submit</span>
          <span class="btn-loading hidden">
            <svg class="spinner" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" stroke-opacity="0.3"/>
              <path d="M10 2C14.4 2 18 5.6 18 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Submitting...
          </span>
        </button>
      </div>

      <!-- Selected Info Panel -->
      <div class="selected-info" id="selected-info" style="display: none;">
        <div class="info-header">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.5"/>
            <path d="M10 9V14M10 6.5V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <span>Selected Requirement Details</span>
        </div>
        <div class="info-content">
          <div class="info-row">
            <span class="info-label">Framework:</span>
            <span class="info-value" id="info-framework">-</span>
          </div>
          <div class="info-row">
            <span class="info-label">Reference ID:</span>
            <span class="info-value" id="info-ref-id">-</span>
          </div>
          <div class="info-row">
            <span class="info-label">Requirement:</span>
            <span class="info-value" id="info-requirement">-</span>
          </div>
        </div>
      </div>
    </main>

    <footer class="footer">
      <p>Data sourced from Muraji API â€¢ AI powered by Google Gemini</p>
    </footer>
  </div>

  <!-- Modal Overlay -->
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal" id="modal">
      <div class="modal-header">
        <div class="modal-title">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span>AI Analysis Results</span>
        </div>
        <button type="button" class="modal-close" id="modal-close" aria-label="Close modal">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- Content will be injected here -->
      </div>
      <div class="modal-footer" id="modal-footer">
        <button type="button" class="btn btn-ghost" id="modal-cancel">
          Cancel
        </button>
        <button type="button" class="btn btn-confirm" id="modal-confirm">
          <svg class="btn-icon" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 9L7 13L15 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span class="btn-text">Confirm</span>
          <span class="btn-loading hidden">
            <svg class="spinner" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="2" stroke-opacity="0.3"/>
              <path d="M9 2C13 2 16 5 16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Saving...
          </span>
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>

  <div class="background-pattern"></div>

  <script src="app.js"></script>
</body>
</html>
